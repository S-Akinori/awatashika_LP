---
import FadeIn from "./FadeIn.astro";
import Title from "./Title.astro";

interface ReviewListItem {
    image: string;
    name: string;
    title: string;
    text: string;
}

const response = await fetch(import.meta.env.CMS_ENDPOINT+'?sheet=review,review_lists');
const data = await response.json();
const review = data['review']?.[0] || {};
const review_lists: ReviewListItem[] = data['review_lists'] || [];
---

<div id="review" class="review-section">
    <FadeIn>
        <Title class="mb-8">{review.title}</Title>
    </FadeIn>
    {review_lists.map((item: ReviewListItem, index: number) => (
        <div class="mb-8">
            <FadeIn delay={`${(index + 1) * 0.2}s`}>
                <div class="md:flex">
                    <div class="md:w-1/3 p-4 relative">
                        <div class="mb-4">
                            <img src={item.image} alt={item.name} class="max-w-full h-auto rounded-full" />
                        </div>
                        <p class="text-center whitespace-pre-wrap">{item.name}</p>
                    </div>
                    <div class="md:w-2/3 p-4">
                        <div class='p-4 border-main border-2 relative h-full'>
                            <div class='inline-block py-4 px-8 absolute left-0 -top-8'>
                                <h3 class="text-lg md:text-xl bg-white">{item.title}</h3>
                            </div>
                            <p class="mt-8">{item.text}</p>
                        </div>
                    </div>
                </div>
            </FadeIn>
        </div>
    ))}
</div>